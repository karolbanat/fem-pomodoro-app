"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,o){return e&&_defineProperties(t.prototype,e),o&&_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){t=_toPrimitive(t,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(t,e){if("object"!==_typeof(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0===o)return("string"===e?String:Number)(t);o=o.call(t,e||"default");if("object"!==_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var settingsButton=document.querySelector("#settings-button"),settingsModal=document.querySelector("#settings-modal"),closeModalButton=document.querySelector("#close-settings-modal-button"),settingsForm=settingsModal.querySelector("#settings-form"),pomodoroTimeInput=settingsForm.querySelector("#pomodoro-time"),shortBreakTimeInput=settingsForm.querySelector("#short-break-time"),longBreakTimeInput=settingsForm.querySelector("#long-break-time"),fontRadioButtons=Array.from(settingsForm.querySelectorAll('input[type="radio"][name="font"]')),colourRadioButtons=Array.from(settingsForm.querySelectorAll('input[type="radio"][name="colour"]')),settingsSubmit=settingsForm.querySelector('button[type="submit"]'),stateForm=document.querySelector("#state-form"),timeStateButtons=Array.from(stateForm.querySelectorAll('input[type="radio"][name="time-state"]')),SECONDS_IN_MINUTE=60,DEFAULT_FONT="sans-serif",DEFAULT_COLOUR="red",DEFAULT_POMODORO_TIME=25,DEFAULT_SHORT_BREAK_TIME=5,DEFAULT_LONG_BREAK_TIME=15,AppTheme=_createClass(function t(){var o=this;_classCallCheck(this,t),this.colour=DEFAULT_COLOUR,this.font=DEFAULT_FONT,this.updateTheme=function(t,e){o.colour=e,o.font=t,document.body.dataset.font=t,document.body.dataset.theme=e}}),PomodoroTimer=_createClass(function t(){var e=this,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;_classCallCheck(this,t),this.observers=[],this.state="INITIAL",this.start=function(){e.setState("COUNTING"),e.count()},this.count=function(){0===e.countingTime?(e.setState("END"),clearTimeout(e.countTimeout)):e.countTimeout=setTimeout(function(){e.updateTime(),e.count()},1e3)},this.pause=function(){e.setState("PAUSED"),clearTimeout(e.countTimeout)},this.restart=function(){e.setState("INITIAL"),e.setTime(e.baseTime),clearTimeout(e.countTimeout)},this.getTime=function(){return e.baseTime},this.getCurrentTime=function(){return e.countingTime},this.setTime=function(t){e.baseTime=t,e.countingTime=t,e.notifyObservers()},this.updateTime=function(){e.countingTime--,e.notifyObservers()},this.getState=function(){return e.state},this.setState=function(t){e.state=t,"END"===e.state&&e.notifyObservers()},this.addObserver=function(t){e.observers.push(t)},this.notifyObservers=function(){e.observers.forEach(function(t){return t.update(e)})},this.baseTime=o,this.countingTime=o}),TimerView=_createClass(function t(e){var r=this;_classCallCheck(this,t),this.update=function(t){r.updateTime(t.getCurrentTime()),r.updateProgressBar(t.getCurrentTime(),t.getTime()),"END"===t.getState()&&(r.updateButtonLabel("restart"),r.updateTimeAnnouncement("polite"),r.resetProgressBar())},this.updateButtonLabel=function(t){r.timerButton.innerText=t},this.updateTime=function(t){r.timerTime.innerHTML=formatTime(t)},this.updateProgressBar=function(t,e){var o=Number(getComputedStyle(r.timeProgressBar).getPropertyValue("--circumference"));r.timeProgressBar.style.setProperty("--progress",((1-t/e)*o).toFixed(0))},this.updateTimeAnnouncement=function(){r.timerTime.setAttribute("aria-live",0<arguments.length&&void 0!==arguments[0]?arguments[0]:"off")},this.resetProgressBar=function(){r.timeProgressBar.style.setProperty("--progress","0")},this.timer=document.querySelector(".timer"),this.timeProgressBar=this.timer.querySelector("#progress-bar"),this.timerTime=this.timer.querySelector("#timer-time"),this.timerButton=this.timer.querySelector("#timer-button"),this.timerButton.addEventListener("click",e)}),PomodoroTimerController=_createClass(function t(e){var o=this;_classCallCheck(this,t),this.timerAction=function(){switch(o.timer.getState()){case"INITIAL":case"PAUSED":o.startTimer();break;case"COUNTING":o.pauseTimer();break;case"END":o.restartTimer()}},this.startTimer=function(){o.timer.start(),o.view.updateButtonLabel("pause")},this.pauseTimer=function(){o.timer.pause(),o.view.updateButtonLabel("start")},this.restartTimer=function(){o.timer.restart(),o.view.updateButtonLabel("start"),o.view.updateTimeAnnouncement()},this.setTime=function(t){o.timer.setTime(t)},this.timer=e,this.view=new TimerView(this.timerAction),e.addObserver(this.view)}),PomodoroApp=_createClass(function t(){var r=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:DEFAULT_POMODORO_TIME,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:DEFAULT_SHORT_BREAK_TIME,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:DEFAULT_LONG_BREAK_TIME;_classCallCheck(this,t),this.appState="POMODORO",this.setTimes=function(t,e,o){r.pomodoroTime=t,r.shortBreakTime=e,r.longBreakTime=o,r.changeState(r.appState)},this.changeState=function(t){r.appState=t,r.timerController.restartTimer(),r.setTimerBasedOnState()},this.setTimerBasedOnState=function(){switch(r.appState){case"POMODORO":r.timerController.setTime(minutesToSeconds(r.pomodoroTime));break;case"SHORT_BREAK":r.timerController.setTime(minutesToSeconds(r.shortBreakTime));break;case"LONG_BREAK":r.timerController.setTime(minutesToSeconds(r.longBreakTime))}},this.timerController=new PomodoroTimerController(new PomodoroTimer),this.setTimes(e,o,i)}),appTheme=new AppTheme,pomodoroApp=new PomodoroApp;function minutesToSeconds(t){return t*SECONDS_IN_MINUTE}function getMinutesFromSeconds(t){return Math.floor(t/SECONDS_IN_MINUTE)}function getRemainingSeconds(t){return t%SECONDS_IN_MINUTE}function addLeadingZero(t){return t<10?"0".concat(t):t.toString()}function formatTime(t){var e=getMinutesFromSeconds(t),t=getRemainingSeconds(t);return addLeadingZero(e)+":"+addLeadingZero(t)}function openModal(){settingsModal.dataset.open="true",closeModalButton.focus()}function closeModal(){settingsModal.dataset.open="false",settingsButton.focus()}settingsSubmit.addEventListener("click",function(t){t.preventDefault();var t=Number(pomodoroTimeInput.value),e=Number(shortBreakTimeInput.value),o=Number(longBreakTimeInput.value),r=fontRadioButtons.find(function(t){return t.checked}).value,i=colourRadioButtons.find(function(t){return t.checked}).value;pomodoroApp.setTimes(t,e,o),appTheme.updateTheme(r,i),closeModal()}),settingsButton.addEventListener("click",openModal),closeModalButton.addEventListener("click",closeModal),timeStateButtons.forEach(function(t){return t.addEventListener("change",function(t){t=t.target.value.toUpperCase();pomodoroApp.changeState(t)})}),document.addEventListener("keydown",function(t){"Tab"===t.key&&(t.shiftKey&&document.activeElement===closeModalButton?(settingsSubmit.focus(),t.preventDefault()):t.shiftKey||document.activeElement!==settingsSubmit||(closeModalButton.focus(),t.preventDefault()))});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4udHMiXSwibmFtZXMiOlsic2V0dGluZ3NCdXR0b24iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJzZXR0aW5nc01vZGFsIiwiY2xvc2VNb2RhbEJ1dHRvbiIsInNldHRpbmdzRm9ybSIsInBvbW9kb3JvVGltZUlucHV0Iiwic2hvcnRCcmVha1RpbWVJbnB1dCIsImxvbmdCcmVha1RpbWVJbnB1dCIsImZvbnRSYWRpb0J1dHRvbnMiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiY29sb3VyUmFkaW9CdXR0b25zIiwic2V0dGluZ3NTdWJtaXQiLCJzdGF0ZUZvcm0iLCJ0aW1lU3RhdGVCdXR0b25zIiwiU0VDT05EU19JTl9NSU5VVEUiLCJERUZBVUxUX0ZPTlQiLCJERUZBVUxUX0NPTE9VUiIsIkRFRkFVTFRfUE9NT0RPUk9fVElNRSIsIkRFRkFVTFRfU0hPUlRfQlJFQUtfVElNRSIsIkRFRkFVTFRfTE9OR19CUkVBS19USU1FIiwiQXBwVGhlbWUiLCJfY3JlYXRlQ2xhc3MiLCJfdGhpcyIsInRoaXMiLCJfY2xhc3NDYWxsQ2hlY2siLCJjb2xvdXIiLCJmb250IiwidXBkYXRlVGhlbWUiLCJib2R5IiwiZGF0YXNldCIsInRoZW1lIiwiUG9tb2Rvcm9UaW1lciIsIl90aGlzMiIsInRpbWUiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJvYnNlcnZlcnMiLCJzdGF0ZSIsInN0YXJ0Iiwic2V0U3RhdGUiLCJjb3VudCIsImNvdW50aW5nVGltZSIsImNsZWFyVGltZW91dCIsImNvdW50VGltZW91dCIsInNldFRpbWVvdXQiLCJ1cGRhdGVUaW1lIiwicGF1c2UiLCJyZXN0YXJ0Iiwic2V0VGltZSIsImJhc2VUaW1lIiwiZ2V0VGltZSIsImdldEN1cnJlbnRUaW1lIiwibm90aWZ5T2JzZXJ2ZXJzIiwiZ2V0U3RhdGUiLCJhZGRPYnNlcnZlciIsIm9ic2VydmVyIiwicHVzaCIsImZvckVhY2giLCJ1cGRhdGUiLCJUaW1lclZpZXciLCJidXR0b25PbkNsaWNrIiwiX3RoaXMzIiwib2JzZXJ2YWJsZSIsIm9icyIsInVwZGF0ZVByb2dyZXNzQmFyIiwidXBkYXRlQnV0dG9uTGFiZWwiLCJ1cGRhdGVUaW1lQW5ub3VuY2VtZW50IiwicmVzZXRQcm9ncmVzc0JhciIsImxhYmVsIiwidGltZXJCdXR0b24iLCJpbm5lclRleHQiLCJ0aW1lclRpbWUiLCJpbm5lckhUTUwiLCJmb3JtYXRUaW1lIiwiY3VycmVudCIsImJhc2UiLCJjaXJjdW1mZXJlbmNlIiwiTnVtYmVyIiwiZ2V0Q29tcHV0ZWRTdHlsZSIsInRpbWVQcm9ncmVzc0JhciIsImdldFByb3BlcnR5VmFsdWUiLCJzdHlsZSIsInNldFByb3BlcnR5IiwidG9GaXhlZCIsInNldEF0dHJpYnV0ZSIsInRpbWVyIiwiYWRkRXZlbnRMaXN0ZW5lciIsIlBvbW9kb3JvVGltZXJDb250cm9sbGVyIiwiX3RoaXM0IiwidGltZXJBY3Rpb24iLCJzdGFydFRpbWVyIiwicGF1c2VUaW1lciIsInJlc3RhcnRUaW1lciIsInZpZXciLCJQb21vZG9yb0FwcCIsIl90aGlzNSIsInBvbW9kb3JvVGltZSIsInNob3J0QnJlYWtUaW1lIiwibG9uZ0JyZWFrVGltZSIsImFwcFN0YXRlIiwic2V0VGltZXMiLCJwb21vZG9ybyIsInNob3J0QnJlYWsiLCJsb25nQnJlYWsiLCJjaGFuZ2VTdGF0ZSIsInRpbWVyQ29udHJvbGxlciIsInNldFRpbWVyQmFzZWRPblN0YXRlIiwibWludXRlc1RvU2Vjb25kcyIsImFwcFRoZW1lIiwicG9tb2Rvcm9BcHAiLCJtaW51dGVzIiwiZ2V0TWludXRlc0Zyb21TZWNvbmRzIiwic2Vjb25kcyIsIk1hdGgiLCJmbG9vciIsImdldFJlbWFpbmluZ1NlY29uZHMiLCJhZGRMZWFkaW5nWmVybyIsImNvbmNhdCIsInRvU3RyaW5nIiwicmVtYWluaW5nU2Vjb25kcyIsIm9wZW5Nb2RhbCIsIm9wZW4iLCJmb2N1cyIsImNsb3NlTW9kYWwiLCJlIiwicHJldmVudERlZmF1bHQiLCJ2YWx1ZSIsImNob3NlbkZvbnQiLCJmaW5kIiwiYnV0dG9uIiwiY2hlY2tlZCIsImNob3NlbkNvbG91ciIsInRhcmdldCIsInRvVXBwZXJDYXNlIiwia2V5Iiwic2hpZnRLZXkiLCJhY3RpdmVFbGVtZW50Il0sIm1hcHBpbmdzIjoiMmpDQUNBLElBQU1BLGVBQW9DQyxTQUFTQyxjQUFjLGtCQUFrQixFQUM3RUMsY0FBNkJGLFNBQVNDLGNBQWMsaUJBQWlCLEVBQ3JFRSxpQkFBc0NILFNBQVNDLGNBQWMsOEJBQThCLEVBRzNGRyxhQUFnQ0YsY0FBY0QsY0FBYyxnQkFBZ0IsRUFDNUVJLGtCQUFzQ0QsYUFBYUgsY0FBYyxnQkFBZ0IsRUFDakZLLG9CQUF3Q0YsYUFBYUgsY0FBYyxtQkFBbUIsRUFDdEZNLG1CQUF1Q0gsYUFBYUgsY0FBYyxrQkFBa0IsRUFDcEZPLGlCQUE0Q0MsTUFBTUMsS0FDdkROLGFBQWFPLGlCQUFpQixrQ0FBa0MsQ0FBQyxFQUU1REMsbUJBQThDSCxNQUFNQyxLQUN6RE4sYUFBYU8saUJBQWlCLG9DQUFvQyxDQUFDLEVBRTlERSxlQUFvQ1QsYUFBYUgsY0FBYyx1QkFBdUIsRUFHdEZhLFVBQTZCZCxTQUFTQyxjQUFjLGFBQWEsRUFDakVjLGlCQUE0Q04sTUFBTUMsS0FDdkRJLFVBQVVILGlCQUFpQix3Q0FBd0MsQ0FBQyxFQUsvREssa0JBQTRCLEdBRTVCQyxhQUFxQixhQUNyQkMsZUFBeUIsTUFFekJDLHNCQUFnQyxHQUNoQ0MseUJBQW1DLEVBQ25DQyx3QkFBa0MsR0E0Q2xDQyxTQUFRQyxhQUFkLFNBQUFELElBQUEsSUFBQUUsRUFBQUMsS0FBQUMsZ0JBQUFELEtBQUFILENBQUEsRUFDQ0csS0FBQUUsT0FBaUJULGVBQ2pCTyxLQUFBRyxLQUFhWCxhQUViUSxLQUFBSSxZQUFjLFNBQUNELEVBQVlELEdBQzFCSCxFQUFLRyxPQUFTQSxFQUNkSCxFQUFLSSxLQUFPQSxFQUNaNUIsU0FBUzhCLEtBQUtDLFFBQVFILEtBQU9BLEVBQzdCNUIsU0FBUzhCLEtBQUtDLFFBQVFDLE1B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QUFNLE9BQUlBLEVBQU9DLE9BQU8sQ0FBQSxFQUFFSixNQUNuRUssRUFBdUIxSCxtQkFBbUJ1SCxLQUFLLFNBQUFDLEdBQU0sT0FBSUEsRUFBT0MsT0FBTyxDQUFBLEVBQUVKLE1BRS9FakIsWUFBWVQsU0FBU0osRUFBY0MsRUFBZ0JDLENBQWEsRUFDaEVVLFNBQVNsRixZQUFZcUcsRUFBWUksQ0FBWSxFQUM3Q1IsV0FBVSxDQUNYLENBQUMsRUFFRC9ILGVBQWUwRixpQkFBaUIsUUFBU2tDLFNBQVMsRUFFbER4SCxpQkFBaUJzRixpQkFBaUIsUUFBU3FDLFVBQVUsRUFFckQvRyxpQkFBaUI2QyxRQUFRLFNBQUF3RSxHQUFNLE9BQzlCQSxFQUFPM0MsaUJBQWlCLFNBQVUsU0FBQ3NDLEdBRTVCdkYsRUFEMkJ1RixFQUFFUSxPQUNLTixNQUFNTyxZQUFXLEVBQ3pEeEIsWUFBWUwsWUFBWW5FLENBQUssQ0FDOUIsQ0FBQyxDQUFDLENBQUEsRUFJSHhDLFNBQVN5RixpQkFBaUIsVUFBVyxTQUFDc0MsR0FDSixRQUFWQSxFQUFFVSxNQUlyQlYsRUFBRVcsVUFBWTFJLFNBQVMySSxnQkFBa0J4SSxrQkFDNUNVLGVBQWVnSCxNQUFLLEVBQ3BCRSxFQUFFQyxlQUFjLEdBSVpELEVBQUVXLFVBQVkxSSxTQUFTMkksZ0JBQWtCOUgsaUJBQzdDVixpQkFBaUIwSCxNQUFLLEVBQ3RCRSxFQUFFQyxlQUFjLEdBRWxCLENBQUMiLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBtb2RhbCBhbmQgbW9kYWwgcmVhbHRlZCBlbGVtZW50cyAqL1xyXG5jb25zdCBzZXR0aW5nc0J1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc2V0dGluZ3MtYnV0dG9uJyk7XHJcbmNvbnN0IHNldHRpbmdzTW9kYWw6IEhUTUxFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NldHRpbmdzLW1vZGFsJyk7XHJcbmNvbnN0IGNsb3NlTW9kYWxCdXR0b246IEhUTUxCdXR0b25FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2Nsb3NlLXNldHRpbmdzLW1vZGFsLWJ1dHRvbicpO1xyXG5cclxuLyogc2V0dGluZ3MgZm9ybSBlbGVtZW50cyAqL1xyXG5jb25zdCBzZXR0aW5nc0Zvcm06IEhUTUxGb3JtRWxlbWVudCA9IHNldHRpbmdzTW9kYWwucXVlcnlTZWxlY3RvcignI3NldHRpbmdzLWZvcm0nKTtcclxuY29uc3QgcG9tb2Rvcm9UaW1lSW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQgPSBzZXR0aW5nc0Zvcm0ucXVlcnlTZWxlY3RvcignI3BvbW9kb3JvLXRpbWUnKTtcclxuY29uc3Qgc2hvcnRCcmVha1RpbWVJbnB1dDogSFRNTElucHV0RWxlbWVudCA9IHNldHRpbmdzRm9ybS5xdWVyeVNlbGVjdG9yKCcjc2hvcnQtYnJlYWstdGltZScpO1xyXG5jb25zdCBsb25nQnJlYWtUaW1lSW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQgPSBzZXR0aW5nc0Zvcm0ucXVlcnlTZWxlY3RvcignI2xvbmctYnJlYWstdGltZScpO1xyXG5jb25zdCBmb250UmFkaW9CdXR0b25zOiBBcnJheTxIVE1MSW5wdXRFbGVtZW50PiA9IEFycmF5LmZyb20oXHJcblx0c2V0dGluZ3NGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0W3R5cGU9XCJyYWRpb1wiXVtuYW1lPVwiZm9udFwiXScpXHJcbik7XHJcbmNvbnN0IGNvbG91clJhZGlvQnV0dG9uczogQXJyYXk8SFRNTElucHV0RWxlbWVudD4gPSBBcnJheS5mcm9tKFxyXG5cdHNldHRpbmdzRm9ybS5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dFt0eXBlPVwicmFkaW9cIl1bbmFtZT1cImNvbG91clwiXScpXHJcbik7XHJcbmNvbnN0IHNldHRpbmdzU3VibWl0OiBIVE1MQnV0dG9uRWxlbWVudCA9IHNldHRpbmdzRm9ybS5xdWVyeVNlbGVjdG9yKCdidXR0b25bdHlwZT1cInN1Ym1pdFwiXScpO1xyXG5cclxuLyogdGltZSBzdGF0ZSBidXR0b25zICovXHJcbmNvbnN0IHN0YXRlRm9ybTogSFRNTEZvcm1FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3N0YXRlLWZvcm0nKTtcclxuY29uc3QgdGltZVN0YXRlQnV0dG9uczogQXJyYXk8SFRNTElucHV0RWxlbWVudD4gPSBBcnJheS5mcm9tKFxyXG5cdHN0YXRlRm9ybS5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dFt0eXBlPVwicmFkaW9cIl1bbmFtZT1cInRpbWUtc3RhdGVcIl0nKVxyXG4pO1xyXG5cclxuLyogY29uc3RhbnRzICovXHJcbi8qIC0tLSBnZW5lcmFsICovXHJcbmNvbnN0IFNFQ09ORFNfSU5fTUlOVVRFOiBudW1iZXIgPSA2MDtcclxuLyogLS0tIHRoZW1lICovXHJcbmNvbnN0IERFRkFVTFRfRk9OVDogRm9udCA9ICdzYW5zLXNlcmlmJztcclxuY29uc3QgREVGQVVMVF9DT0xPVVI6IENvbG91ciA9ICdyZWQnO1xyXG4vKiAtLS0gdGltZXMgKi9cclxuY29uc3QgREVGQVVMVF9QT01PRE9ST19USU1FOiBudW1iZXIgPSAyNTtcclxuY29uc3QgREVGQVVMVF9TSE9SVF9CUkVBS19USU1FOiBudW1iZXIgPSA1O1xyXG5jb25zdCBERUZBVUxUX0xPTkdfQlJFQUtfVElNRTogbnVtYmVyID0gMTU7XHJcblxyXG4vKiB0eXBlcyAqL1xyXG50eXBlIENvbG91ciA9ICdyZWQnIHwgJ2N5YW4nIHwgJ3Zpb2xldCc7XHJcbnR5cGUgRm9udCA9ICdzZXJpZicgfCAnc2Fucy1zZXJpZicgfCAnbW9ub3NwYWNlJztcclxudHlwZSBUaW1lclN0YXRlID0gJ0lOSVRJQUwnIHwgJ0NPVU5USU5HJyB8ICdQQVVTRUQnIHwgJ0VORCc7XHJcbnR5cGUgUG9tb2Rvcm9BcHBTdGF0ZXMgPSAnUE9NT0RPUk8nIHwgJ1NIT1JUX0JSRUFLJyB8ICdMT05HX0JSRUFLJztcclxuXHJcbi8qIGludGVyZmFjZXMgKi9cclxuaW50ZXJmYWNlIE9ic2VydmFibGUge1xyXG5cdGFkZE9ic2VydmVyOiAob2JzZXJ2ZXI6IE9ic2VydmVyKSA9PiB2b2lkO1xyXG5cdG5vdGlmeU9ic2VydmVyczogKCkgPT4gdm9pZDtcclxufVxyXG5cclxuaW50ZXJmYWNlIE9ic2VydmVyIHtcclxuXHR1cGRhdGU6IChvYnNlcnZhYmxlOiBPYnNlcnZhYmxlKSA9PiB2b2lkO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgVGhlbWUge1xyXG5cdGNvbG91cjogQ29sb3VyO1xyXG5cdGZvbnQ6IEZvbnQ7XHJcblx0dXBkYXRlVGhlbWU6IChmb250OiBGb250LCBjb2xvdXI6IENvbG91cikgPT4gdm9pZDtcclxufVxyXG5cclxuaW50ZXJmYWNlIFRpbWVyIGV4dGVuZHMgT2JzZXJ2YWJsZSB7XHJcblx0c3RhdGU6IFRpbWVyU3RhdGU7XHJcblx0c3RhcnQ6ICgpID0+IHZvaWQ7XHJcblx0cGF1c2U6ICgpID0+IHZvaWQ7XHJcblx0cmVzdGFydDogKCkgPT4gdm9pZDtcclxuXHRzZXRUaW1lOiAodGltZTogbnVtYmVyKSA9PiB2b2lkO1xyXG5cdGdldFRpbWU6ICgpID0+IG51bWJlcjtcclxuXHRnZXRDdXJyZW50VGltZTogKCkgPT4gbnVtYmVyO1xyXG5cdGdldFN0YXRlOiAoKSA9PiBUaW1lclN0YXRlO1xyXG5cdHNldFN0YXRlOiAoc3RhdGU6IFRpbWVyU3RhdGUpID0+IHZvaWQ7XHJcbn1cclxuXHJcbmludGVyZmFjZSBUaW1lckNvbnRyb2xsZXIge1xyXG5cdHN0YXJ0VGltZXI6ICgpID0+IHZvaWQ7XHJcblx0cGF1c2VUaW1lcjogKCkgPT4gdm9pZDtcclxuXHRyZXN0YXJ0VGltZXI6ICgpID0+IHZvaWQ7XHJcblx0c2V0VGltZTogKHRpbWU6IG51bWJlcikgPT4gdm9pZDtcclxufVxyXG5cclxuLyogY2xhc3NlcyAqL1xyXG5jbGFzcyBBcHBUaGVtZSBpbXBsZW1lbnRzIFRoZW1lIHtcclxuXHRjb2xvdXI6IENvbG91ciA9IERFRkFVTFRfQ09MT1VSO1xyXG5cdGZvbnQ6IEZvbnQgPSBERUZBVUxUX0ZPTlQ7XHJcblxyXG5cdHVwZGF0ZVRoZW1lID0gKGZvbnQ6IEZvbnQsIGNvbG91cjogQ29sb3VyKTogdm9pZCA9PiB7XHJcblx0XHR0aGlzLmNvbG91ciA9IGNvbG91cjtcclxuXHRcdHRoaXMuZm9udCA9IGZvbnQ7XHJcblx0XHRkb2N1bWVudC5ib2R5LmRhdGFzZXQuZm9udCA9IGZvbnQ7XHJcblx0XHRkb2N1bWVudC5ib2R5LmRhdGFzZXQudGhlbWUgPSBjb2xvdXI7XHJcblx0fTtcclxufVxyXG5cclxuY2xhc3MgUG9tb2Rvcm9UaW1lciBpbXBsZW1lbnRzIFRpbWVyIHtcclxuXHRvYnNlcnZlcnM6IE9ic2VydmVyW10gPSBbXTtcclxuXHRjb3VudFRpbWVvdXQ6IE5vZGVKUy5UaW1lb3V0O1xyXG5cdHN0YXRlOiBUaW1lclN0YXRlID0gJ0lOSVRJQUwnO1xyXG5cclxuXHRwcml2YXRlIGNvdW50aW5nVGltZTogbnVtYmVyO1xyXG5cdHByaXZhdGUgYmFzZVRpbWU6IG51bWJlcjtcclxuXHJcblx0Y29uc3RydWN0b3IodGltZTogbnVtYmVyID0gMCkge1xyXG5cdFx0dGhpcy5iYXNlVGltZSA9IHRpbWU7XHJcblx0XHR0aGlzLmNvdW50aW5nVGltZSA9IHRpbWU7XHJcblx0fVxyXG5cclxuXHRzdGFydCA9ICgpOiB2b2lkID0+IHtcclxuXHRcdHRoaXMuc2V0U3RhdGUoJ0NPVU5USU5HJyk7XHJcblx0XHR0aGlzLmNvdW50KCk7XHJcblx0fTtcclxuXHJcblx0Y291bnQgPSAoKTogdm9pZCA9PiB7XHJcblx0XHRpZiAodGhpcy5jb3VudGluZ1RpbWUgPT09IDApIHtcclxuXHRcdFx0dGhpcy5zZXRTdGF0ZSgnRU5EJyk7XHJcblx0XHRcdGNsZWFyVGltZW91dCh0aGlzLmNvdW50VGltZW91dCk7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmNvdW50VGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG5cdFx0XHR0aGlzLnVwZGF0ZVRpbWUoKTtcclxuXHRcdFx0dGhpcy5jb3VudCgpO1xyXG5cdFx0fSwgMTAwMCk7XHJcblx0fTtcclxuXHJcblx0cGF1c2UgPSAoKTogdm9pZCA9PiB7XHJcblx0XHR0aGlzLnNldFN0YXRlKCdQQVVTRUQnKTtcclxuXHRcdGNsZWFyVGltZW91dCh0aGlzLmNvdW50VGltZW91dCk7XHJcblx0fTtcclxuXHJcblx0cmVzdGFydCA9ICgpOiB2b2lkID0+IHtcclxuXHRcdHRoaXMuc2V0U3RhdGUoJ0lOSVRJQUwnKTtcclxuXHRcdHRoaXMuc2V0VGltZSh0aGlzLmJhc2VUaW1lKTtcclxuXHRcdGNsZWFyVGltZW91dCh0aGlzLmNvdW50VGltZW91dCk7XHJcblx0fTtcclxuXHJcblx0Z2V0VGltZSA9ICgpOiBudW1iZXIgPT4gdGhpcy5iYXNlVGltZTtcclxuXHJcblx0Z2V0Q3VycmVudFRpbWUgPSAoKTogbnVtYmVyID0+IHRoaXMuY291bnRpbmdUaW1lO1xyXG5cclxuXHRzZXRUaW1lID0gKHRpbWU6IG51bWJlcik6IHZvaWQgPT4ge1xyXG5cdFx0dGhpcy5iYXNlVGltZSA9IHRpbWU7XHJcblx0XHR0aGlzLmNvdW50aW5nVGltZSA9IHRpbWU7XHJcblx0XHR0aGlzLm5vdGlmeU9ic2VydmVycygpO1xyXG5cdH07XHJcblxyXG5cdHVwZGF0ZVRpbWUgPSAoKTogdm9pZCA9PiB7XHJcblx0XHR0aGlzLmNvdW50aW5nVGltZS0tO1xyXG5cdFx0dGhpcy5ub3RpZnlPYnNlcnZlcnMoKTtcclxuXHR9O1xyXG5cclxuXHRnZXRTdGF0ZSA9ICgpOiBUaW1lclN0YXRlID0+IHRoaXMuc3RhdGU7XHJcblxyXG5cdHNldFN0YXRlID0gKHN0YXRlOiBUaW1lclN0YXRlKTogdm9pZCA9PiB7XHJcblx0XHR0aGlzLnN0YXRlID0gc3RhdGU7XHJcblxyXG5cdFx0aWYgKHRoaXMuc3RhdGUgPT09ICdFTkQnKSB0aGlzLm5vdGlmeU9ic2VydmVycygpO1xyXG5cdH07XHJcblxyXG5cdC8qIG9ic2VydmVyIGltcGxlbWVudGF0aW9uICovXHJcblx0YWRkT2JzZXJ2ZXIgPSAob2JzZXJ2ZXI6IE9ic2VydmVyKTogdm9pZCA9PiB7XHJcblx0XHR0aGlzLm9ic2VydmVycy5wdXNoKG9ic2VydmVyKTtcclxuXHR9O1xyXG5cclxuXHRub3RpZnlPYnNlcnZlcnMgPSAoKTogdm9pZCA9PiB7XHJcblx0XHR0aGlzLm9ic2VydmVycy5mb3JFYWNoKG9ic2VydmVyID0+IG9ic2VydmVyLnVwZGF0ZSh0aGlzKSk7XHJcblx0fTtcclxufVxyXG5cclxuY2xhc3MgVGltZXJWaWV3IGltcGxlbWVudHMgT2JzZXJ2ZXIge1xyXG5cdHByaXZhdGUgdGltZXI6IEhUTUxFbGVtZW50O1xyXG5cdHByaXZhdGUgdGltZVByb2dyZXNzQmFyOiBIVE1MRWxlbWVudDtcclxuXHRwcml2YXRlIHRpbWVyVGltZTogSFRNTEVsZW1lbnQ7XHJcblx0cHJpdmF0ZSB0aW1lckJ1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQ7XHJcblxyXG5cdGNvbnN0cnVjdG9yKGJ1dHRvbk9uQ2xpY2s6IChlOiBFdmVudCkgPT4gdm9pZCkge1xyXG5cdFx0dGhpcy50aW1lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50aW1lcicpO1xyXG5cdFx0dGhpcy50aW1lUHJvZ3Jlc3NCYXIgPSB0aGlzLnRpbWVyLnF1ZXJ5U2VsZWN0b3IoJyNwcm9ncmVzcy1iYXInKTtcclxuXHRcdHRoaXMudGltZXJUaW1lID0gdGhpcy50aW1lci5xdWVyeVNlbGVjdG9yKCcjdGltZXItdGltZScpO1xyXG5cdFx0dGhpcy50aW1lckJ1dHRvbiA9IHRoaXMudGltZXIucXVlcnlTZWxlY3RvcignI3RpbWVyLWJ1dHRvbicpO1xyXG5cdFx0dGhpcy50aW1lckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGJ1dHRvbk9uQ2xpY2spO1xyXG5cdH1cclxuXHJcblx0dXBkYXRlID0gKG9ic2VydmFibGU6IE9ic2VydmFibGUpOiB2b2lkID0+IHtcclxuXHRcdGNvbnN0IG9iczogVGltZXIgPSBvYnNlcnZhYmxlIGFzIFRpbWVyO1xyXG5cdFx0dGhpcy51cGRhdGVUaW1lKG9icy5nZXRDdXJyZW50VGltZSgpKTtcclxuXHRcdHRoaXMudXBkYXRlUHJvZ3Jlc3NCYXIob2JzLmdldEN1cnJlbnRUaW1lKCksIG9icy5nZXRUaW1lKCkpO1xyXG5cclxuXHRcdGlmIChvYnMuZ2V0U3RhdGUoKSA9PT0gJ0VORCcpIHtcclxuXHRcdFx0dGhpcy51cGRhdGVCdXR0b25MYWJlbCgncmVzdGFydCcpO1xyXG5cdFx0XHR0aGlzLnVwZGF0ZVRpbWVBbm5vdW5jZW1lbnQoJ3BvbGl0ZScpO1xyXG5cdFx0XHR0aGlzLnJlc2V0UHJvZ3Jlc3NCYXIoKTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHR1cGRhdGVCdXR0b25MYWJlbCA9IChsYWJlbDogc3RyaW5nKTogdm9pZCA9PiB7XHJcblx0XHR0aGlzLnRpbWVyQnV0dG9uLmlubmVyVGV4dCA9IGxhYmVsO1xyXG5cdH07XHJcblxyXG5cdHVwZGF0ZVRpbWUgPSAodGltZTogbnVtYmVyKTogdm9pZCA9PiB7XHJcblx0XHR0aGlzLnRpbWVyVGltZS5pbm5lckhUTUwgPSBmb3JtYXRUaW1lKHRpbWUpO1xyXG5cdH07XHJcblxyXG5cdHVwZGF0ZVByb2dyZXNzQmFyID0gKGN1cnJlbnQ6IG51bWJlciwgYmFzZTogbnVtYmVyKTogdm9pZCA9PiB7XHJcblx0XHRjb25zdCBjaXJjdW1mZXJlbmNlOiBudW1iZXIgPSBOdW1iZXIoZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLnRpbWVQcm9ncmVzc0JhcikuZ2V0UHJvcGVydHlWYWx1ZSgnLS1jaXJjdW1mZXJlbmNlJykpO1xyXG5cdFx0dGhpcy50aW1lUHJvZ3Jlc3NCYXIuc3R5bGUuc2V0UHJvcGVydHkoJy0tcHJvZ3Jlc3MnLCAoKDEgLSBjdXJyZW50IC8gYmFzZSkgKiBjaXJjdW1mZXJlbmNlKS50b0ZpeGVkKDApKTtcclxuXHR9O1xyXG5cclxuXHR1cGRhdGVUaW1lQW5ub3VuY2VtZW50ID0gKHZhbHVlOiBzdHJpbmcgPSAnb2ZmJyk6IHZvaWQgPT4ge1xyXG5cdFx0dGhpcy50aW1lclRpbWUuc2V0QXR0cmlidXRlKCdhcmlhLWxpdmUnLCB2YWx1ZSk7XHJcblx0fTtcclxuXHJcblx0cmVzZXRQcm9ncmVzc0JhciA9ICgpOiB2b2lkID0+IHtcclxuXHRcdHRoaXMudGltZVByb2dyZXNzQmFyLnN0eWxlLnNldFByb3BlcnR5KCctLXByb2dyZXNzJywgJzAnKTtcclxuXHR9O1xyXG59XHJcblxyXG5jbGFzcyBQb21vZG9yb1RpbWVyQ29udHJvbGxlciBpbXBsZW1lbnRzIFRpbWVyQ29udHJvbGxlciB7XHJcblx0cHJpdmF0ZSB0aW1lcjogVGltZXI7XHJcblx0cHJpdmF0ZSB2aWV3OiBUaW1lclZpZXc7XHJcblx0Y29uc3RydWN0b3IodGltZXI6IFRpbWVyKSB7XHJcblx0XHR0aGlzLnRpbWVyID0gdGltZXI7XHJcblx0XHR0aGlzLnZpZXcgPSBuZXcgVGltZXJWaWV3KHRoaXMudGltZXJBY3Rpb24pO1xyXG5cclxuXHRcdHRpbWVyLmFkZE9ic2VydmVyKHRoaXMudmlldyk7XHJcblx0fVxyXG5cclxuXHR0aW1lckFjdGlvbiA9ICgpOiB2b2lkID0+IHtcclxuXHRcdHN3aXRjaCAodGhpcy50aW1lci5nZXRTdGF0ZSgpKSB7XHJcblx0XHRcdGNhc2UgJ0lOSVRJQUwnOlxyXG5cdFx0XHRjYXNlICdQQVVTRUQnOlxyXG5cdFx0XHRcdHRoaXMuc3RhcnRUaW1lcigpO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlICdDT1VOVElORyc6XHJcblx0XHRcdFx0dGhpcy5wYXVzZVRpbWVyKCk7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgJ0VORCc6XHJcblx0XHRcdFx0dGhpcy5yZXN0YXJ0VGltZXIoKTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHRzdGFydFRpbWVyID0gKCk6IHZvaWQgPT4ge1xyXG5cdFx0dGhpcy50aW1lci5zdGFydCgpO1xyXG5cdFx0dGhpcy52aWV3LnVwZGF0ZUJ1dHRvbkxhYmVsKCdwYXVzZScpO1xyXG5cdH07XHJcblxyXG5cdHBhdXNlVGltZXIgPSAoKTogdm9pZCA9PiB7XHJcblx0XHR0aGlzLnRpbWVyLnBhdXNlKCk7XHJcblx0XHR0aGlzLnZpZXcudXBkYXRlQnV0dG9uTGFiZWwoJ3N0YXJ0Jyk7XHJcblx0fTtcclxuXHJcblx0cmVzdGFydFRpbWVyID0gKCk6IHZvaWQgPT4ge1xyXG5cdFx0dGhpcy50aW1lci5yZXN0YXJ0KCk7XHJcblx0XHR0aGlzLnZpZXcudXBkYXRlQnV0dG9uTGFiZWwoJ3N0YXJ0Jyk7XHJcblx0XHR0aGlzLnZpZXcudXBkYXRlVGltZUFubm91bmNlbWVudCgpO1xyXG5cdH07XHJcblxyXG5cdHNldFRpbWUgPSAodGltZTogbnVtYmVyKTogdm9pZCA9PiB7XHJcblx0XHR0aGlzLnRpbWVyLnNldFRpbWUodGltZSk7XHJcblx0fTtcclxufVxyXG5cclxuY2xhc3MgUG9tb2Rvcm9BcHAge1xyXG5cdHByaXZhdGUgdGltZXJDb250cm9sbGVyOiBUaW1lckNvbnRyb2xsZXI7XHJcblx0cHJpdmF0ZSBhcHBTdGF0ZTogUG9tb2Rvcm9BcHBTdGF0ZXMgPSAnUE9NT0RPUk8nO1xyXG5cclxuXHRwcml2YXRlIHBvbW9kb3JvVGltZTogbnVtYmVyO1xyXG5cdHByaXZhdGUgc2hvcnRCcmVha1RpbWU6IG51bWJlcjtcclxuXHRwcml2YXRlIGxvbmdCcmVha1RpbWU6IG51bWJlcjtcclxuXHJcblx0Y29uc3RydWN0b3IoXHJcblx0XHRwb21vZG9yb1RpbWU6IG51bWJlciA9IERFRkFVTFRfUE9NT0RPUk9fVElNRSxcclxuXHRcdHNob3J0QnJlYWtUaW1lOiBudW1iZXIgPSBERUZBVUxUX1NIT1JUX0JSRUFLX1RJTUUsXHJcblx0XHRsb25nQnJlYWtUaW1lOiBudW1iZXIgPSBERUZBVUxUX0xPTkdfQlJFQUtfVElNRVxyXG5cdCkge1xyXG5cdFx0dGhpcy50aW1lckNvbnRyb2xsZXIgPSBuZXcgUG9tb2Rvcm9UaW1lckNvbnRyb2xsZXIobmV3IFBvbW9kb3JvVGltZXIoKSk7XHJcblx0XHR0aGlzLnNldFRpbWVzKHBvbW9kb3JvVGltZSwgc2hvcnRCcmVha1RpbWUsIGxvbmdCcmVha1RpbWUpO1xyXG5cdH1cclxuXHJcblx0c2V0VGltZXMgPSAocG9tb2Rvcm86IG51bWJlciwgc2hvcnRCcmVhazogbnVtYmVyLCBsb25nQnJlYWs6IG51bWJlcik6IHZvaWQgPT4ge1xyXG5cdFx0dGhpcy5wb21vZG9yb1RpbWUgPSBwb21vZG9ybztcclxuXHRcdHRoaXMuc2hvcnRCcmVha1RpbWUgPSBzaG9ydEJyZWFrO1xyXG5cdFx0dGhpcy5sb25nQnJlYWtUaW1lID0gbG9uZ0JyZWFrO1xyXG5cdFx0dGhpcy5jaGFuZ2VTdGF0ZSh0aGlzLmFwcFN0YXRlKTtcclxuXHR9O1xyXG5cclxuXHRjaGFuZ2VTdGF0ZSA9IChzdGF0ZTogUG9tb2Rvcm9BcHBTdGF0ZXMpOiB2b2lkID0+IHtcclxuXHRcdHRoaXMuYXBwU3RhdGUgPSBzdGF0ZTtcclxuXHRcdHRoaXMudGltZXJDb250cm9sbGVyLnJlc3RhcnRUaW1lcigpO1xyXG5cdFx0dGhpcy5zZXRUaW1lckJhc2VkT25TdGF0ZSgpO1xyXG5cdH07XHJcblxyXG5cdHNldFRpbWVyQmFzZWRPblN0YXRlID0gKCk6IHZvaWQgPT4ge1xyXG5cdFx0c3dpdGNoICh0aGlzLmFwcFN0YXRlKSB7XHJcblx0XHRcdGNhc2UgJ1BPTU9ET1JPJzpcclxuXHRcdFx0XHR0aGlzLnRpbWVyQ29udHJvbGxlci5zZXRUaW1lKG1pbnV0ZXNUb1NlY29uZHModGhpcy5wb21vZG9yb1RpbWUpKTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSAnU0hPUlRfQlJFQUsnOlxyXG5cdFx0XHRcdHRoaXMudGltZXJDb250cm9sbGVyLnNldFRpbWUobWludXRlc1RvU2Vjb25kcyh0aGlzLnNob3J0QnJlYWtUaW1lKSk7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgJ0xPTkdfQlJFQUsnOlxyXG5cdFx0XHRcdHRoaXMudGltZXJDb250cm9sbGVyLnNldFRpbWUobWludXRlc1RvU2Vjb25kcyh0aGlzLmxvbmdCcmVha1RpbWUpKTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdH1cclxuXHR9O1xyXG59XHJcblxyXG5jb25zdCBhcHBUaGVtZTogVGhlbWUgPSBuZXcgQXBwVGhlbWUoKTtcclxuY29uc3QgcG9tb2Rvcm9BcHA6IFBvbW9kb3JvQXBwID0gbmV3IFBvbW9kb3JvQXBwKCk7XHJcblxyXG4vKiBldmVudCBsaXN0ZW5lcnMgKi9cclxuc2V0dGluZ3NTdWJtaXQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZTogRXZlbnQpID0+IHtcclxuXHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG5cdGNvbnN0IHBvbW9kb3JvVGltZSA9IE51bWJlcihwb21vZG9yb1RpbWVJbnB1dC52YWx1ZSk7XHJcblx0Y29uc3Qgc2hvcnRCcmVha1RpbWUgPSBOdW1iZXIoc2hvcnRCcmVha1RpbWVJbnB1dC52YWx1ZSk7XHJcblx0Y29uc3QgbG9uZ0JyZWFrVGltZSA9IE51bWJlcihsb25nQnJlYWtUaW1lSW5wdXQudmFsdWUpO1xyXG5cdGNvbnN0IGNob3NlbkZvbnQ6IEZvbnQgPSBmb250UmFkaW9CdXR0b25zLmZpbmQoYnV0dG9uID0+IGJ1dHRvbi5jaGVja2VkKS52YWx1ZSBhcyBGb250O1xyXG5cdGNvbnN0IGNob3NlbkNvbG91cjogQ29sb3VyID0gY29sb3VyUmFkaW9CdXR0b25zLmZpbmQoYnV0dG9uID0+IGJ1dHRvbi5jaGVja2VkKS52YWx1ZSBhcyBDb2xvdXI7XHJcblxyXG5cdHBvbW9kb3JvQXBwLnNldFRpbWVzKHBvbW9kb3JvVGltZSwgc2hvcnRCcmVha1RpbWUsIGxvbmdCcmVha1RpbWUpO1xyXG5cdGFwcFRoZW1lLnVwZGF0ZVRoZW1lKGNob3NlbkZvbnQsIGNob3NlbkNvbG91cik7XHJcblx0Y2xvc2VNb2RhbCgpO1xyXG59KTtcclxuXHJcbnNldHRpbmdzQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb3Blbk1vZGFsKTtcclxuXHJcbmNsb3NlTW9kYWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZU1vZGFsKTtcclxuXHJcbnRpbWVTdGF0ZUJ1dHRvbnMuZm9yRWFjaChidXR0b24gPT5cclxuXHRidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGU6IEV2ZW50KSA9PiB7XHJcblx0XHRjb25zdCBidXR0b246IEhUTUxJbnB1dEVsZW1lbnQgPSBlLnRhcmdldCBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG5cdFx0Y29uc3Qgc3RhdGU6IFBvbW9kb3JvQXBwU3RhdGVzID0gYnV0dG9uLnZhbHVlLnRvVXBwZXJDYXNlKCkgYXMgUG9tb2Rvcm9BcHBTdGF0ZXM7XHJcblx0XHRwb21vZG9yb0FwcC5jaGFuZ2VTdGF0ZShzdGF0ZSk7XHJcblx0fSlcclxuKTtcclxuXHJcbi8qIC0tIHRyYXBzIGZvY3VzIG9uIHdpdGhpbiBzZXR0aW5ncyBtb2RhbCB3aGVuIGl0IGlzIG9wZW5lZCAqL1xyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGU6IEtleWJvYXJkRXZlbnQpID0+IHtcclxuXHRjb25zdCBpc1RhYjogYm9vbGVhbiA9IGUua2V5ID09PSAnVGFiJztcclxuXHJcblx0aWYgKCFpc1RhYikgcmV0dXJuO1xyXG5cclxuXHRpZiAoZS5zaGlmdEtleSAmJiBkb2N1bWVudC5hY3RpdmVFbGVtZW50ID09PSBjbG9zZU1vZGFsQnV0dG9uKSB7XHJcblx0XHRzZXR0aW5nc1N1Ym1pdC5mb2N1cygpO1xyXG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHJcblx0aWYgKCFlLnNoaWZ0S2V5ICYmIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgPT09IHNldHRpbmdzU3VibWl0KSB7XHJcblx0XHRjbG9zZU1vZGFsQnV0dG9uLmZvY3VzKCk7XHJcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0fVxyXG59KTtcclxuXHJcbi8qIGhlbHBlciBmdW5jdGlvbnMgKi9cclxuLyogLS0tIHRpbWVyICovXHJcbmZ1bmN0aW9uIG1pbnV0ZXNUb1NlY29uZHMobWludXRlczogbnVtYmVyKTogbnVtYmVyIHtcclxuXHRyZXR1cm4gbWludXRlcyAqIFNFQ09ORFNfSU5fTUlOVVRFO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRNaW51dGVzRnJvbVNlY29uZHMoc2Vjb25kczogbnVtYmVyKTogbnVtYmVyIHtcclxuXHRyZXR1cm4gTWF0aC5mbG9vcihzZWNvbmRzIC8gU0VDT05EU19JTl9NSU5VVEUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRSZW1haW5pbmdTZWNvbmRzKHNlY29uZHM6IG51bWJlcik6IG51bWJlciB7XHJcblx0cmV0dXJuIHNlY29uZHMgJSBTRUNPTkRTX0lOX01JTlVURTtcclxufVxyXG5cclxuZnVuY3Rpb24gYWRkTGVhZGluZ1plcm8odGltZTogbnVtYmVyKTogc3RyaW5nIHtcclxuXHRyZXR1cm4gdGltZSA8IDEwID8gYDAke3RpbWV9YCA6IHRpbWUudG9TdHJpbmcoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZm9ybWF0VGltZShzZWNvbmRzOiBudW1iZXIpOiBzdHJpbmcge1xyXG5cdGNvbnN0IG1pbnV0ZXMgPSBnZXRNaW51dGVzRnJvbVNlY29uZHMoc2Vjb25kcyk7XHJcblx0Y29uc3QgcmVtYWluaW5nU2Vjb25kcyA9IGdldFJlbWFpbmluZ1NlY29uZHMoc2Vjb25kcyk7XHJcblx0cmV0dXJuIGFkZExlYWRpbmdaZXJvKG1pbnV0ZXMpICsgJzonICsgYWRkTGVhZGluZ1plcm8ocmVtYWluaW5nU2Vjb25kcyk7XHJcbn1cclxuXHJcbi8qIC0tLSBtb2RhbCAqL1xyXG5mdW5jdGlvbiBvcGVuTW9kYWwoKSB7XHJcblx0c2V0dGluZ3NNb2RhbC5kYXRhc2V0Lm9wZW4gPSAndHJ1ZSc7XHJcblx0Y2xvc2VNb2RhbEJ1dHRvbi5mb2N1cygpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjbG9zZU1vZGFsKCkge1xyXG5cdHNldHRpbmdzTW9kYWwuZGF0YXNldC5vcGVuID0gJ2ZhbHNlJztcclxuXHRzZXR0aW5nc0J1dHRvbi5mb2N1cygpO1xyXG59XHJcbiJdfQ==
